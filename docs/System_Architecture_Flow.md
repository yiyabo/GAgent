# AI-Driven Agentç³»ç»Ÿæ¶æ„æµç¨‹å›¾

## ç³»ç»Ÿæ¦‚è¿°

æœ¬æ–‡æ¡£å±•ç¤ºäº†AI-Drivené€’å½’ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿä»æ¥æ”¶ä»»åŠ¡åˆ°ç”Ÿæˆæœ€ç»ˆè¾“å‡ºçš„å®Œæ•´å¤„ç†æµç¨‹ï¼ŒåŒ…æ‹¬æ™ºèƒ½ä»»åŠ¡åˆ†è§£ã€ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ‰§è¡Œç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## ğŸ”„ å®Œæ•´ç³»ç»Ÿæµç¨‹å›¾

```mermaid
flowchart TD
    A[ç”¨æˆ·è¾“å…¥ä»»åŠ¡ç›®æ ‡] --> B{æ˜¯å¦æŒ‡å®šsectionsæ•°é‡?}
    B -->|æ˜¯| C[ä½¿ç”¨æŒ‡å®šæ•°é‡]
    B -->|å¦/auto| D[AIæ™ºèƒ½å†³å®šä»»åŠ¡æ•°é‡]
    
    C --> E[è°ƒç”¨Planning Service]
    D --> E
    
    E --> F[LLMç”Ÿæˆåˆå§‹è®¡åˆ’]
    F --> G[åˆ›å»ºROOTä»»åŠ¡å’Œå­ä»»åŠ¡]
    G --> H[ä»»åŠ¡å­˜å‚¨åˆ°SQLiteæ•°æ®åº“]
    
    H --> I[å¼€å§‹æ‰§è¡Œæµç¨‹]
    I --> J[BFSè°ƒåº¦å™¨è·å–å¾…æ‰§è¡Œä»»åŠ¡]
    
    J --> K{ä»»åŠ¡éœ€è¦åˆ†è§£?}
    K -->|æ˜¯| L[é€’å½’ä»»åŠ¡åˆ†è§£]
    K -->|å¦| M[å‡†å¤‡æ‰§è¡Œä»»åŠ¡]
    
    L --> N[åˆ¤æ–­ä»»åŠ¡ç±»å‹]
    N --> O{ä»»åŠ¡ç±»å‹}
    O -->|ROOT| P[åˆ†è§£ä¸ºCOMPOSITEä»»åŠ¡]
    O -->|COMPOSITE| Q[åˆ†è§£ä¸ºATOMICä»»åŠ¡]
    O -->|ATOMIC| R[æ— éœ€åˆ†è§£]
    
    P --> S[è°ƒç”¨LLMç”Ÿæˆå­ä»»åŠ¡]
    Q --> S
    S --> T[åˆ›å»ºå­ä»»åŠ¡å¹¶å­˜å‚¨]
    T --> U[æ›´æ–°ä»»åŠ¡å±‚çº§å…³ç³»]
    U --> J
    
    R --> M
    M --> V[æ”¶é›†ä»»åŠ¡ä¸Šä¸‹æ–‡]
    
    V --> W[ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ¨¡å—]
    W --> X[æ”¶é›†ä¾èµ–ä»»åŠ¡ä¸Šä¸‹æ–‡]
    W --> Y[æ”¶é›†å…„å¼Ÿä»»åŠ¡ä¸Šä¸‹æ–‡]  
    W --> Z[TF-IDFè¯­ä¹‰æ£€ç´¢ç›¸å…³ä»»åŠ¡]
    W --> AA[æ”¶é›†æ‰‹åŠ¨æŒ‡å®šä¸Šä¸‹æ–‡]
    
    X --> BB[ä¸Šä¸‹æ–‡é¢„ç®—ç®¡ç†]
    Y --> BB
    Z --> BB
    AA --> BB
    
    BB --> CC[ç”Ÿæˆå¢å¼ºæç¤ºè¯]
    CC --> DD[è°ƒç”¨LLMæ‰§è¡Œä»»åŠ¡]
    DD --> EE[ç”Ÿæˆä»»åŠ¡è¾“å‡º]
    EE --> FF[å­˜å‚¨ä»»åŠ¡ç»“æœ]
    
    FF --> GG{è¿˜æœ‰å¾…æ‰§è¡Œä»»åŠ¡?}
    GG -->|æ˜¯| J
    GG -->|å¦| HH[èšåˆæ‰€æœ‰ä»»åŠ¡è¾“å‡º]
    
    HH --> II[ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š]
    II --> JJ[è¾“å‡ºåˆ°æ–‡ä»¶ output.md]
    
    style A fill:#e1f5fe
    style JJ fill:#c8e6c9
    style L fill:#fff3e0
    style W fill:#f3e5f5
    style DD fill:#ffebee
```

## ğŸ“‹ ASCIIæµç¨‹å›¾ (Markdownç‰ˆæœ¬)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·è¾“å…¥ä»»åŠ¡ç›®æ ‡     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ sectionsæ•°é‡ï¼Ÿ   â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚     â”‚
     æŒ‡å®š  â”‚     â”‚ auto/ç©º
          â–¼     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ä½¿ç”¨æŒ‡å®šå€¼ â”‚ â”‚AIæ™ºèƒ½å†³å®šæ•°é‡  â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ è°ƒç”¨Planning Service â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ LLMç”Ÿæˆåˆå§‹è®¡åˆ’       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ åˆ›å»ºROOTä»»åŠ¡å’Œå­ä»»åŠ¡   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä»»åŠ¡å­˜å‚¨åˆ°SQLiteæ•°æ®åº“ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    å¼€å§‹æ‰§è¡Œæµç¨‹       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚BFSè°ƒåº¦å™¨è·å–å¾…æ‰§è¡Œä»»åŠ¡  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ä»»åŠ¡éœ€è¦åˆ†è§£ï¼Ÿ  â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”˜
               â”‚   â”‚
            æ˜¯ â”‚   â”‚ å¦
               â–¼   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ é€’å½’ä»»åŠ¡åˆ†è§£ â”‚ â”‚ å‡†å¤‡æ‰§è¡Œä»»åŠ¡ â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚               â”‚
          â–¼               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚ åˆ¤æ–­ä»»åŠ¡ç±»å‹ â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
          â”‚               â”‚
          â–¼               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚   ä»»åŠ¡ç±»å‹   â”‚       â”‚
    â”‚ ROOT/COMPOSITE/     â”‚
    â”‚    ATOMIC   â”‚       â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
          â”‚               â”‚
          â–¼               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚è°ƒç”¨LLMç”Ÿæˆå­ä»»åŠ¡â”‚     â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
          â”‚               â”‚
          â–¼               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚åˆ›å»ºå­ä»»åŠ¡å¹¶å­˜å‚¨â”‚      â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
          â”‚               â”‚
          â–¼               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚æ›´æ–°ä»»åŠ¡å±‚çº§å…³ç³»â”‚      â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
          â”‚               â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ å›åˆ°BFSè°ƒåº¦å™¨
                          â”‚
                          â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   æ”¶é›†ä»»åŠ¡ä¸Šä¸‹æ–‡  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ¨¡å—   â”‚
                â”‚                 â”‚
                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                â”‚ â”‚ä¾èµ–ä»»åŠ¡ä¸Šä¸‹æ–‡â”‚ â”‚
                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                â”‚ â”‚å…„å¼Ÿä»»åŠ¡ä¸Šä¸‹æ–‡â”‚ â”‚
                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                â”‚ â”‚TF-IDFè¯­ä¹‰æ£€ç´¢â”‚ â”‚
                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                â”‚ â”‚æ‰‹åŠ¨æŒ‡å®šä¸Šä¸‹æ–‡â”‚ â”‚
                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  ä¸Šä¸‹æ–‡é¢„ç®—ç®¡ç†   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  ç”Ÿæˆå¢å¼ºæç¤ºè¯   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  è°ƒç”¨LLMæ‰§è¡Œä»»åŠ¡  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   ç”Ÿæˆä»»åŠ¡è¾“å‡º    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   å­˜å‚¨ä»»åŠ¡ç»“æœ    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚è¿˜æœ‰å¾…æ‰§è¡Œä»»åŠ¡ï¼Ÿâ”‚
                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”˜
                         â”‚   â”‚
                      æ˜¯ â”‚   â”‚ å¦
                         â”‚   â–¼
                         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ â”‚èšåˆæ‰€æœ‰ä»»åŠ¡è¾“å‡º  â”‚
                         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚           â”‚
                         â”‚           â–¼
                         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ â”‚  ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š    â”‚
                         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚           â”‚
                         â”‚           â–¼
                         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ â”‚è¾“å‡ºåˆ°æ–‡ä»¶output.mdâ”‚
                         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â””â”€â”€â”€ å›åˆ°BFSè°ƒåº¦å™¨
```

### ğŸ”§ ä»»åŠ¡åˆ†è§£è¯¦ç»†æµç¨‹

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   ä»»åŠ¡åˆ†è§£å…¥å£   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   åˆ¤æ–­ä»»åŠ¡ç±»å‹   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   ä»»åŠ¡ç±»å‹   â”‚
                       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚            â”‚            â”‚
                â–¼            â–¼            â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    ROOT     â”‚ â”‚  COMPOSITE  â”‚ â”‚   ATOMIC    â”‚
        â”‚   æ ¹ä»»åŠ¡    â”‚ â”‚   å¤åˆä»»åŠ¡   â”‚ â”‚   åŸå­ä»»åŠ¡   â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚               â”‚
              â–¼               â–¼               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  å¯åˆ†è§£ âœ“   â”‚ â”‚  å¯åˆ†è§£ âœ“   â”‚ â”‚ ä¸å¯åˆ†è§£ âœ—  â”‚
        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚               â”‚               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â–¼
                      â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â–¼             â”‚   ç›´æ¥æ‰§è¡Œ   â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚  è°ƒç”¨LLMåˆ†è§£    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ ç”Ÿæˆå­ä»»åŠ¡åˆ—è¡¨   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   åˆ›å»ºå­ä»»åŠ¡    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  å»ºç«‹çˆ¶å­å…³ç³»   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ é€’å½’æ£€æŸ¥å­ä»»åŠ¡   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ§  ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ‰§è¡Œæµç¨‹

```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ä»»åŠ¡å‡†å¤‡æ‰§è¡Œ   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ä¸Šä¸‹æ–‡æ”¶é›†å™¨   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚           â”‚           â”‚
      â–¼           â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ä¾èµ–ä»»åŠ¡ â”‚ â”‚å…„å¼Ÿä»»åŠ¡ â”‚ â”‚TF-IDFè¯­ä¹‰   â”‚
â”‚ä¸Šä¸‹æ–‡   â”‚ â”‚ä¸Šä¸‹æ–‡   â”‚ â”‚æ£€ç´¢ç›¸å…³ä»»åŠ¡  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚           â”‚            â”‚
     â–¼           â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚requires â”‚ â”‚sibling  â”‚ â”‚è®¡ç®—TF-IDF   â”‚
â”‚refers   â”‚ â”‚tasks    â”‚ â”‚ç›¸ä¼¼åº¦       â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚           â”‚            â”‚
     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
           â”‚           â”‚
           â–¼           â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   ä¸Šä¸‹æ–‡é¢„ç®—ç®¡ç†     â”‚
     â”‚                    â”‚
     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
     â”‚ â”‚ æŒ‰ä¼˜å…ˆçº§æ’åº     â”‚ â”‚
     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
     â”‚ â”‚ æˆªæ–­åˆ°é¢„ç®—é™åˆ¶   â”‚ â”‚
     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   ç”Ÿæˆå¢å¼ºæç¤ºè¯     â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   LLMæ‰§è¡Œä»»åŠ¡       â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ è¯¦ç»†æµç¨‹è¯´æ˜

### 1. ä»»åŠ¡æ¥æ”¶ä¸è®¡åˆ’ç”Ÿæˆé˜¶æ®µ

```mermaid
flowchart LR
    A[ç”¨æˆ·è¾“å…¥] --> B[CLIå‚æ•°è§£æ]
    B --> C{sectionså‚æ•°}
    C -->|æŒ‡å®šæ•°é‡| D[ä½¿ç”¨æŒ‡å®šå€¼]
    C -->|auto/ç©º| E[AIæ™ºèƒ½å†³å®š]
    D --> F[Planning Service]
    E --> F
    F --> G[LLMç”ŸæˆJSONè®¡åˆ’]
    G --> H[è§£æå¹¶åˆ›å»ºä»»åŠ¡æ ‘]
```

**å…³é”®ç»„ä»¶:**
- `agent_cli.py` - CLIå…¥å£ç‚¹
- `app/services/planning.py` - è®¡åˆ’ç”ŸæˆæœåŠ¡
- `app/repository/tasks.py` - ä»»åŠ¡å­˜å‚¨

### 2. é€’å½’ä»»åŠ¡åˆ†è§£æœºåˆ¶

```mermaid
flowchart TD
    A[ä»»åŠ¡åˆ†è§£å…¥å£] --> B[åˆ¤æ–­ä»»åŠ¡ç±»å‹]
    B --> C{ä»»åŠ¡ç±»å‹åˆ¤æ–­}
    
    C -->|ROOT| D[æ ¹ä»»åŠ¡]
    C -->|COMPOSITE| E[å¤åˆä»»åŠ¡]  
    C -->|ATOMIC| F[åŸå­ä»»åŠ¡]
    
    D --> G[å¯åˆ†è§£ âœ“]
    E --> G
    F --> H[ä¸å¯åˆ†è§£ âœ—]
    
    G --> I[è°ƒç”¨LLMåˆ†è§£]
    I --> J[ç”Ÿæˆå­ä»»åŠ¡åˆ—è¡¨]
    J --> K[åˆ›å»ºå­ä»»åŠ¡]
    K --> L[å»ºç«‹çˆ¶å­å…³ç³»]
    L --> M[é€’å½’æ£€æŸ¥å­ä»»åŠ¡]
    
    H --> N[ç›´æ¥æ‰§è¡Œ]
    M --> B
```

**åˆ†è§£è§„åˆ™:**
- **ROOTä»»åŠ¡** â†’ åˆ†è§£ä¸ºå¤šä¸ªCOMPOSITEä»»åŠ¡
- **COMPOSITEä»»åŠ¡** â†’ åˆ†è§£ä¸ºå¤šä¸ªATOMICä»»åŠ¡  
- **ATOMICä»»åŠ¡** â†’ ä¸å†åˆ†è§£ï¼Œç›´æ¥æ‰§è¡Œ
- **æœ€å¤§æ·±åº¦é™åˆ¶** â†’ é˜²æ­¢æ— é™é€’å½’

### 3. ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ‰§è¡Œæœºåˆ¶

```mermaid
flowchart TD
    A[ä»»åŠ¡å‡†å¤‡æ‰§è¡Œ] --> B[ä¸Šä¸‹æ–‡æ”¶é›†å™¨]
    
    B --> C[ä¾èµ–ä»»åŠ¡ä¸Šä¸‹æ–‡]
    B --> D[å…„å¼Ÿä»»åŠ¡ä¸Šä¸‹æ–‡]
    B --> E[TF-IDFè¯­ä¹‰æ£€ç´¢]
    B --> F[æ‰‹åŠ¨æŒ‡å®šä¸Šä¸‹æ–‡]
    
    C --> G[requireså…³ç³»]
    C --> H[referså…³ç³»]
    
    D --> I[åŒçº§ä»»åŠ¡è¾“å…¥è¾“å‡º]
    
    E --> J[è®¡ç®—TF-IDFç›¸ä¼¼åº¦]
    J --> K[é€‰æ‹©top-kç›¸å…³ä»»åŠ¡]
    
    F --> L[ç”¨æˆ·æŒ‡å®šçš„ç›¸å…³ä»»åŠ¡]
    
    G --> M[ä¸Šä¸‹æ–‡é¢„ç®—ç®¡ç†]
    H --> M
    I --> M
    K --> M
    L --> M
    
    M --> N[æŒ‰ä¼˜å…ˆçº§æ’åº]
    N --> O[æˆªæ–­åˆ°é¢„ç®—é™åˆ¶]
    O --> P[ç”Ÿæˆå¢å¼ºæç¤ºè¯]
    P --> Q[LLMæ‰§è¡Œä»»åŠ¡]
```

**ä¸Šä¸‹æ–‡ç±»å‹:**
- `dep:requires` - å¼ºä¾èµ–ä»»åŠ¡
- `dep:refers` - å¼•ç”¨ä»»åŠ¡
- `sibling` - å…„å¼Ÿä»»åŠ¡
- `retrieved` - è¯­ä¹‰ç›¸å…³ä»»åŠ¡
- `manual` - æ‰‹åŠ¨æŒ‡å®šä»»åŠ¡

### 4. BFSè°ƒåº¦æ‰§è¡Œæµç¨‹

```mermaid
flowchart LR
    A[BFSè°ƒåº¦å™¨å¯åŠ¨] --> B[è·å–æ‰€æœ‰å¾…æ‰§è¡Œä»»åŠ¡]
    B --> C[æŒ‰ä¼˜å…ˆçº§æ’åº]
    C --> D[é€‰æ‹©ä¸‹ä¸€ä¸ªä»»åŠ¡]
    D --> E{ä»»åŠ¡éœ€è¦åˆ†è§£?}
    
    E -->|æ˜¯| F[æ‰§è¡Œåˆ†è§£æµç¨‹]
    E -->|å¦| G[æ‰§è¡Œä»»åŠ¡]
    
    F --> H[åˆ›å»ºå­ä»»åŠ¡]
    H --> I[æ›´æ–°ä»»åŠ¡çŠ¶æ€]
    I --> B
    
    G --> J[æ”¶é›†ä¸Šä¸‹æ–‡]
    J --> K[è°ƒç”¨LLM]
    K --> L[ä¿å­˜è¾“å‡º]
    L --> M[æ ‡è®°å®Œæˆ]
    M --> N{è¿˜æœ‰ä»»åŠ¡?}
    
    N -->|æ˜¯| B
    N -->|å¦| O[æ‰§è¡Œå®Œæˆ]
```

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„ç»„ä»¶

### æ ¸å¿ƒæœåŠ¡æ¨¡å—

```
app/services/
â”œâ”€â”€ planning.py              # è®¡åˆ’ç”ŸæˆæœåŠ¡
â”œâ”€â”€ recursive_decomposition.py  # é€’å½’åˆ†è§£æœåŠ¡
â”œâ”€â”€ context.py               # ä¸Šä¸‹æ–‡æ„ŸçŸ¥æœåŠ¡
â”œâ”€â”€ context_budget.py        # ä¸Šä¸‹æ–‡é¢„ç®—ç®¡ç†
â””â”€â”€ index_root.py           # æ ¹ä»»åŠ¡ç´¢å¼•
```

### æ•°æ®å­˜å‚¨å±‚

```
app/repository/
â”œâ”€â”€ tasks.py                # ä»»åŠ¡ä»“åº“(SQLite)
â””â”€â”€ __init__.py
```

### æ‰§è¡Œå¼•æ“

```
app/
â”œâ”€â”€ executor.py             # ä»»åŠ¡æ‰§è¡Œå™¨
â”œâ”€â”€ scheduler.py            # BFSè°ƒåº¦å™¨
â””â”€â”€ main.py                # FastAPIæœåŠ¡
```

## ğŸ”§ å…³é”®ç®—æ³•

### 1. ä»»åŠ¡ç±»å‹åˆ¤æ–­ç®—æ³•

```python
def determine_task_type(task):
    name = task.get("name", "").lower()
    task_type = task.get("task_type", "").lower()
    
    # æ˜¾å¼ç±»å‹ä¼˜å…ˆ
    if task_type in ["root", "composite", "atomic"]:
        return TaskType(task_type.upper())
    
    # åŸºäºåç§°æ¨æ–­
    if any(keyword in name for keyword in ["ç ”ç©¶", "æŠ¥å‘Š", "é¡¹ç›®"]):
        return TaskType.ROOT
    elif any(keyword in name for keyword in ["åˆ†æ", "æ”¶é›†", "è®¾è®¡"]):
        return TaskType.COMPOSITE
    else:
        return TaskType.ATOMIC
```

### 2. TF-IDFè¯­ä¹‰æ£€ç´¢ç®—æ³•

```python
def tfidf_retrieve_similar_tasks(query_tokens, candidates, k=3):
    # è®¡ç®—TF-IDFå‘é‡
    vectorizer = TfidfVectorizer()
    corpus = [query] + [task_content for task_content in candidates]
    tfidf_matrix = vectorizer.fit_transform(corpus)
    
    # è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦
    similarities = cosine_similarity(tfidf_matrix[0:1], tfidf_matrix[1:])
    
    # è¿”å›top-kç›¸ä¼¼ä»»åŠ¡
    top_indices = similarities.argsort()[0][-k:][::-1]
    return [candidates[i] for i in top_indices]
```

### 3. ä¸Šä¸‹æ–‡é¢„ç®—ç®¡ç†

```python
def apply_budget(sections, max_chars=8000):
    # æŒ‰ä¼˜å…ˆçº§æ’åº
    priority_order = ["dep:requires", "dep:refers", "sibling", "retrieved", "manual"]
    sections.sort(key=lambda s: priority_order.index(s.get("kind", "manual")))
    
    # ç´¯ç§¯å­—ç¬¦æ•°ï¼Œæˆªæ–­è¶…å‡ºé¢„ç®—çš„éƒ¨åˆ†
    total_chars = 0
    result = []
    for section in sections:
        content_len = len(section.get("content", ""))
        if total_chars + content_len <= max_chars:
            result.append(section)
            total_chars += content_len
        else:
            break
    
    return result
```

## ğŸ“Š æ€§èƒ½ç‰¹æ€§

- **å¹¶å‘æ‰§è¡Œ**: BFSè°ƒåº¦å™¨æ”¯æŒä»»åŠ¡å¹¶å‘æ‰§è¡Œ
- **å†…å­˜ä¼˜åŒ–**: ä¸Šä¸‹æ–‡é¢„ç®—ç®¡ç†é˜²æ­¢å†…å­˜æº¢å‡º
- **å®¹é”™æœºåˆ¶**: ä»»åŠ¡æ‰§è¡Œå¤±è´¥æ—¶çš„é‡è¯•å’Œé™çº§ç­–ç•¥
- **å¯æ‰©å±•æ€§**: æ¨¡å—åŒ–è®¾è®¡æ”¯æŒæ–°åŠŸèƒ½æ‰©å±•

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

```bash
# 1. ç”Ÿæˆè®¡åˆ’(AIè‡ªåŠ¨å†³å®šä»»åŠ¡æ•°)
python agent_cli.py plan "è›‹ç™½è´¨ç»“åˆä½ç‚¹ç ”ç©¶" --sections auto

# 2. æ‰§è¡Œè®¡åˆ’(å¯ç”¨ä¸Šä¸‹æ–‡æ„ŸçŸ¥)
python agent_cli.py execute "è›‹ç™½è´¨ç»“åˆä½ç‚¹ç ”ç©¶" --use-context --save-snapshot

# 3. æ‰‹åŠ¨åˆ†è§£ç‰¹å®šä»»åŠ¡
curl -X POST "http://localhost:8000/tasks/105/decompose" \
  -H "Content-Type: application/json" \
  -d '{"max_subtasks": 5}'

# 4. è·å–ä»»åŠ¡ä¸Šä¸‹æ–‡
curl "http://localhost:8000/tasks/105/context?include_deps=true&tfidf_k=3"
```

---

*æœ¬æ–‡æ¡£å±•ç¤ºäº†AI-Driven Agentç³»ç»Ÿçš„å®Œæ•´æ¶æ„æµç¨‹ï¼Œæ¶µç›–äº†ä»ä»»åŠ¡æ¥æ”¶åˆ°æœ€ç»ˆè¾“å‡ºçš„æ‰€æœ‰å…³é”®ç¯èŠ‚ã€‚*
